# 数据库设计

### **一、核心实体类型及属性**

#### **1. 用户实体（User）**

* **属性**：
  * `user_id`：用户唯一标识（主键，自增整数）
  * `username`：用户名（字符串，唯一）
  * `password`：密码（加密字符串）
  * `nickname`：昵称（字符串）
  * `gender`：性别（枚举值：男 / 女 / 保密）
  * `phone`：手机号（字符串，唯一）
  * `email`：邮箱（字符串）
  * `avatar`：头像地址（字符串，URL）
  * `signature`：个性签名（字符串）
  * `score`：积分（整数，默认 0）
  * `create_time`：注册时间（时间戳）
* **说明**：存储用户基本信息，用于登录、社区互动、积分体系等。

#### **2. 商家实体（Merchant）**

* **属性**：
  * `merchant_id`：商家唯一标识（主键，自增整数）
  * `merchant_name`：商家名称（字符串，唯一）
  * `address`：地址（字符串）
  * `contact_phone`：联系电话（字符串）
  * `contact_email`：联系邮箱（字符串
  * `business_hours`：营业时间（字符串，如 “09:00-21:00”）
  * `logo`：商家 LOGO 地址（字符串，URL）
  * `introduction`：店铺介绍（文本）
  * `avg_score`：平均评分（浮点数，默认 0.0）
  * `status`：状态（枚举值：审核中 / 营业中 / 暂停营业，默认 “审核中”）
  * `create_time`：入驻时间（时间戳）
* **关联属性**：
  * `category_id`：所属菜系类别（外键，关联菜系实体）
* **说明**：存储商家基础信息，用于推荐、搜索及商家后台管理。

#### **3. 菜品实体（Dish）**

* **属性**：
  * `dish_id`：菜品唯一标识（主键，自增整数）
  * `dish_name`：菜品名称（字符串）
  * `description`：菜品介绍（文本，含食材、烹饪方式等）
  * `price`：价格（浮点数）
  * `image_url`：菜品图片地址（字符串，URL）
  * `sales_count`：销量（整数，默认 0）
* **关联属性**：
  * `merchant_id`：所属商家（外键，关联商家实体）
* **说明**：存储菜品信息，用于推荐榜、商家详情页展示。

#### **4. 菜系实体（Category）**

* **属性**：
  * `category_id`：菜系唯一标识（主键，自增整数）
  * `category_name`：菜系名称（字符串，如 “川菜”“粤菜”）
* **说明**：用于分类管理商家和菜品，支持搜索筛选。

#### **5. 评价实体（Comment）**

* **属性**：
  * `comment_id`：评价唯一标识（主键，自增整数）
  * `content`：评价内容（文本）
  * `score`：评分（整数，1-5 分）
  * `service_score`：服务评分（整数，1-5 分，可选）
  * `environment_score`：环境评分（整数，1-5 分，可选）
  * `create_time`：评价时间（时间戳）
  * `is_verified`：是否为消费后评价（布尔值，默认 False）
* **关联属性**：
  * `user_id`：评价用户（外键，关联用户实体）
  * `merchant_id`：评价商家（外键，关联商家实体）
  * `dish_id`：评价菜品（外键，关联菜品实体，可选）
* **说明**：存储用户对商家 / 菜品的评价，用于评分计算和展示。

#### **6. 推荐算法日志实体（RecommendationLog）**

* **属性**：
  * `log_id`：日志唯一标识（主键，自增整数）
  * `recommend_time`：推荐时间（时间戳）
  * `algorithm_type`：算法类型（字符串，如 “协同过滤”“基于内容”）
  * `parameters`：算法参数（JSON 格式，如 “{distance: 1000m, category: 川菜}”）
* **关联属性**：
  * `user_id`：接收推荐的用户（外键，关联用户实体）
  * `merchant_ids`：推荐的商家 ID 列表（JSON 数组）
* **说明**：记录推荐算法的执行日志，用于优化推荐模型。

### **二、关联实体类型及属性**

#### **1. 用户收藏关联（UserFavorite）**

* **属性**：
  * `favorite_id`：收藏记录唯一标识（主键，自增整数）
  * `create_time`：收藏时间（时间戳）
* **关联属性**：
  * `user_id`：收藏用户（外键，关联用户实体）
  * `merchant_id`：收藏的商家（外键，关联商家实体）
  * `dish_id`：收藏的菜品（外键，关联菜品实体，可选）
* **说明**：记录用户收藏的商家或菜品，用于个人中心展示。

#### **2. 动态互动关联（DynamicInteraction）**

* **属性**：
  * `interaction_id`：互动记录唯一标识（主键，自增整数）
  * `type`：互动类型（枚举值：评论 / 点赞 / 收藏，默认 “评论”）
  * `create_time`：互动时间（时间戳）
* **关联属性**：
  * `user_id`：互动用户（外键，关联用户实体）
  * `dynamic_id`：被互动的动态 ID（外键，关联社区动态实体）
* **说明**：记录用户在社区的互动行为（如评论、点赞动态）。

#### **3. 社区动态实体（Dynamic）**

* **属性**：
  * `dynamic_id`：动态唯一标识（主键，自增整数）
  * `content`：动态内容（文本，支持图文 / 视频链接）
  * `create_time`：发布时间（时间戳）
  * `like_count`：点赞数（整数，默认 0）
  * `comment_count`：评论数（整数，默认 0）
* **关联属性**：
  * `user_id`：发布用户（外键，关联用户实体）
* **说明**：存储用户发布的社区动态，支持话题标签（可通过关键词提取或单独实体管理）。

### **三、辅助实体类型及属性**

#### **1. 优惠券实体（Coupon）**

* **属性**：
  * `coupon_id`：优惠券唯一标识（主键，自增整数）
  * `name`：优惠券名称（字符串，如 “新人满减券”）
  * `type`：类型（枚举值：满减券 / 折扣券 / 无门槛券）
  * `value`：优惠金额 / 折扣率（浮点数，如 “满 100 减 30” 中的 30）
  * `min_amount`：满减门槛（浮点数，可选）
  * `valid_date`：有效期（日期范围）
  * `quantity`：总发行量（整数）
  * `remaining`：剩余数量（整数，默认 = quantity）
* **关联属性**：
  * `merchant_id`：适用商家（外键，关联商家实体，可选，支持平台通用券）
* **说明**：用于营销活动，用户可领取并抵扣消费。

#### **2. 订单实体（Order）**

* **属性**：
  * `order_id`：订单唯一标识（主键，字符串，如 “ORD202505271234”）
  * `order_type`：订单类型（枚举值：外卖 / 团购 / 到店预订）
  * `status`：订单状态（枚举值：待付款 / 待配送 / 已完成 / 已取消）
  * `total_amount`：订单总额（浮点数）
  * `create_time`：下单时间（时间戳）
  * `pay_time`：支付时间（时间戳，可选）
* **关联属性**：
  * `user_id`：下单用户（外键，关联用户实体）
  * `merchant_id`：服务商家（外键，关联商家实体）
  * `coupon_id`：使用的优惠券（外键，关联优惠券实体，可选）
* **说明**：记录用户消费订单，支持多菜品关联（通过订单详情实体扩展）。
